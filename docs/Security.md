

# APPKEY, SECRET 관리

키움에 REST API 사용 신청을 한 후, 각 계좌 별 APPKEY 및 SECRET 키를 부여 받습니다.

이 키는 토큰 생성 요청 시 필요한데, 절대로 외부에 노출이 되면 안되는 중요한 정보이므로, 이 정보를 기록한 파일은 git 저장소에서 관리되지 않도록 예외 처리 해야 합니다.

이 프로젝트에서는 dotenv 파이썬 패키지를 이용하여 관리합니다.
dotenv 가 사용하는 디폴트 파일 이름인 `.env` 파일은 리포지토리 root, 또는 검색 가능한 적절한 영역에 저장해야 하며, 개발자가 스스로 관리(생성, 업데이트) 해야 합니다.

대략 다음과 같이 기록하면 됩니다.
```
$ cat <path>/.env
KIWOOM_API_APPKEY = "APPKEY_문자열"
KIWOOM_API_SECRET = "SECRET_문자열"
```

파일명 `.env`는 .gitignore에 등록되어 있습니다.

<br>

# 토큰 관리

APPKEY 와 SECRET 을 이용하여 접근 권한 토큰을 요청하면 서버로부터 토큰을 받습니다. 현재 시점에서 확인해 보면, 키움 서버가 제공한 토큰은 유효기간이 24시간 이며, 이는 향후에 변경될 수 있습니다.

이전에 생성된 토큰이 아직 유효한 동안은, 동일하게 토큰을 요청하면 계속 동일한 응답을 받습니다. 따라서 어딘가에 토큰을 저장해 둔 후 재사용하는 것이 좋습니다.

실행 된 후 오랫동안 지속적으로 동작하는 프로세스라면 그냥 메모리에 저장해 두고 재사용하면 되겠지만, 현재와 같은 PoC 단계에서는 단위 시험용 모듈을 반복하여 실행을 하기 때문에 어딘가 영구적인 곳에 저장을 하는 것이 필요합니다.

앞서 APPKEY 와 유사하게, 이 접근 권한용 토큰은 임시 파일에 저장한 후 dotenv를 이용하여 읽는 방법으로 구현합니다.

이 방법은 권한을 가진 다른 사용자 또는 프로세스가 토큰에 접근할 수 있다는 문제가 있습니다만, PoC가 진행 되는 동안에만 사용하고, PoC가 완료된 후에는 해당 기능은 제거해야 합니다.

참고로, 임시 파일 경로는 소스 코드 내부에 하드 코딩 되어 있습니다.

